<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>قلب و حرف M — رسم تلقائي</title>
  <style>
    :root{
      --bg: #0f1724;
      --accent: #ff4d6d; /* لون القلب */
      --accent-dark: #d83a57;
      --letter: #ffffff;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: Inter, system-ui, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(255,77,109,0.06), transparent),
                  radial-gradient(800px 400px at 90% 90%, rgba(13,27,44,0.12), transparent),
                  var(--bg);
      color: #fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      box-sizing:border-box;
    }

    .card{
      width:min(560px, 92vw);
      aspect-ratio: 1 / 1;
      display:grid;
      place-items:center;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:20px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
      padding:18px;
      position:relative;
      overflow:hidden;
    }

    svg{
      width:70%;
      height:auto;
      display:block;
    }

    /* stroke-draw animation helpers */
    .path{
      stroke-linecap:round;
      stroke-linejoin:round;
      stroke-width:8;
      fill:transparent;
      stroke:var(--accent);
      stroke-dasharray: 1000;
      stroke-dashoffset: 1000;
      transition: stroke-dashoffset 1.6s cubic-bezier(.2,.9,.3,1);
    }

    .path.filled{
      fill: var(--accent);
      stroke: var(--accent-dark);
      stroke-width:2;
      stroke-dasharray: 0;
      stroke-dashoffset: 0;
      transition: fill 0.4s ease 0.1s, stroke 0.4s ease 0.1s;
    }

    .letter{
      stroke: var(--letter);
      stroke-width:6;
      fill:transparent;
      stroke-dasharray: 500;
      stroke-dashoffset: 500;
      transition: stroke-dashoffset 1.2s cubic-bezier(.2,.9,.3,1) 0.5s;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.6));
    }

    /* pulse effect after draw */
    .pulse {
      animation: pulse 1.6s ease-in-out 0.9s 2;
      transform-origin: 50% 50%;
    }

    @keyframes pulse{
      0% { transform: scale(1);   }
      40% { transform: scale(1.06); }
      100% { transform: scale(1); }
    }

    /* small text / controls */
    .controls{
      position:absolute;
      left:12px;
      top:12px;
      font-size:13px;
      opacity:0.8;
      display:flex;
      gap:8px;
      align-items:center;
    }

    .btn{
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.04);
      color: #fff;
      padding:6px 10px;
      border-radius:8px;
      cursor:pointer;
      font-size:13px;
    }

    .small{
      position:absolute;
      right:12px;
      bottom:12px;
      font-size:12px;
      opacity:0.6;
    }

    @media (max-width:420px){
      .card{ border-radius:14px; padding:14px; }
      .path{ stroke-width:6; }
      .letter{ stroke-width:5; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="img" aria-label="قلب مع حرف M">
      <div class="controls" aria-hidden="true">
        <button id="replay" class="btn" title="إعادة الرسمة">إعادة</button>
        <button id="toggleFill" class="btn" title="تبديل التعبئة">تعبئة</button>
      </div>

      <!-- SVG: قلب و حرف M -->
      <svg id="art" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="false" role="img">
        <!-- قلب path (مصمم ب bezier) -->
        <path id="heart" class="path" d="
          M100 170
          C100 170, 20 120, 35 70
          C45 36, 80 36, 100 60
          C120 36, 155 36, 165 70
          C180 120, 100 170, 100 170 Z" />

        <!-- حرف M كمسار (مُبسّط) -->
        <path id="letterM" class="letter" d="
          M58 110
          L66 70
          L86 105
          L98 70
          L108 110" stroke-linecap="round" stroke-linejoin="round"/>

        <!-- invisible background circle for click / accessible focus -->
        <circle cx="100" cy="100" r="95" fill="transparent" />
      </svg>

      <div class="small">Press "إعادة" أو اضغط على القلب</div>
    </div>
  </div>

  <script>
    // عناصر
    const heart = document.getElementById('heart');
    const letter = document.getElementById('letterM');
    const replayBtn = document.getElementById('replay');
    const toggleFillBtn = document.getElementById('toggleFill');
    const svg = document.getElementById('art');

    // تحضير الطول لرسم stroke-animation
    function preparePath(path){
      const length = path.getTotalLength();
      path.style.strokeDasharray = length;
      path.style.strokeDashoffset = length;
      // force reflow
      path.getBoundingClientRect();
      return length;
    }

    let heartLen = preparePath(heart);
    let letterLen = preparePath(letter);

    // تشغيل الرسمة (رسم الخطوط تدريجياً)
    function playDraw({fillHeart = false} = {}){
      // reset
      heart.style.transition = 'none';
      letter.style.transition = 'none';
      heart.style.strokeDashoffset = heartLen;
      letter.style.strokeDashoffset = letterLen;
      heart.classList.remove('filled');
      svg.classList.remove('pulse');

      // small timeout to allow resetting styles
      requestAnimationFrame(() => {
        // enable transitions again
        heart.style.transition = 'stroke-dashoffset 1.6s cubic-bezier(.2,.9,.3,1)';
        letter.style.transition = 'stroke-dashoffset 1.2s cubic-bezier(.2,.9,.3,1) 0.4s';

        // start drawing
        heart.style.strokeDashoffset = 0;
        letter.style.strokeDashoffset = 0;

        // after drawing finishes, optionally fill the heart and pulse
        setTimeout(() => {
          if (fillHeart) {
            heart.classList.add('filled');
          }
          // pulse
          svg.classList.add('pulse');
        }, 1200);
      });
    }

    // تعاملات المستخدم
    replayBtn.addEventListener('click', () => playDraw({fillHeart: heart.classList.contains('filled')}));
    toggleFillBtn.addEventListener('click', () => {
      if (heart.classList.contains('filled')) {
        heart.classList.remove('filled');
      } else {
        heart.classList.add('filled');
      }
    });

    // اضغط على الـ SVG لإعادة الرسم و للتفاعل
    svg.addEventListener('click', () => playDraw({fillHeart: !heart.classList.contains('filled')}));
    svg.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') playDraw({fillHeart: !heart.classList.contains('filled')});
    });

    // بدء تلقائي عند تحميل الصفحة
    window.addEventListener('load', () => playDraw({fillHeart:true}));

    // سهولة التخصيص: لو تبي تغير الحرف
    // مثلاً: لتغيير الحرف من M إلى حرف آخر، تحتاج ترسم مسار جديد داخل <path id="letterM" d="..."/>
    // لو تبي أضيف خيار إدخال الحرف تلقائيًا (تحويل حرف إلى مسار SVG) أقدر أعمل لك وظيفة تحويل.
  </script>
</body>
</html>
