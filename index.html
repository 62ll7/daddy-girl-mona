<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mona — Challenge & Gift Code</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@300;500;700&display=swap" rel="stylesheet">
<meta name="theme-color" content="#ff5b89" />
<style>
  :root{
    --bg1:#100b22; --bg2:#1b1235;
    --accent:#ff5b89; --accent2:#ff8fb3; --accent3:#a387ff;
    --soft:#ffe3ec; --text:#fff;
    --ok:#67e8f9; --warn:#fde68a; --err:#fca5a5;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:
    radial-gradient(900px 600px at 10% 20%, rgba(255,91,137,.14), transparent 60%),
    radial-gradient(800px 500px at 90% 80%, rgba(163,135,255,.12), transparent 60%),
    linear-gradient(180deg,var(--bg2),var(--bg1));
    color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial;}
  .wrap{min-height:100%;display:grid;place-items:center;padding:22px}
  .card{
    width:min(820px, 94vw);border-radius:28px;position:relative;overflow:hidden;
    background:linear-gradient(180deg,rgba(255,255,255,.035),rgba(255,255,255,.02));
    box-shadow:0 20px 60px rgba(0,0,0,.65), inset 0 0 0 1px rgba(255,255,255,.06);
    padding:22px 20px 26px; isolation:isolate;
  }
  header{display:grid;place-items:center;text-align:center;margin-bottom:10px}
  .brand{font-family:"Great Vibes",cursive;font-size:clamp(40px,9vw,100px);line-height:1.05;filter:drop-shadow(0 10px 22px rgba(255,91,137,.22))}
  .tag{color:var(--soft);opacity:.95;margin-top:4px}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:center}
  .section{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;min-width:min(560px, 100%);box-shadow:inset 0 0 0 1px rgba(255,255,255,.02)}
  label{font-size:14px;opacity:.9;margin-bottom:6px;display:block}
  input[type="text"], input[type="number"]{
    width:100%; padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.12);
    background:rgba(255,255,255,.06);color:#fff;font-size:16px;outline:none;
  }
  input::placeholder{color:#ddd;opacity:.6}
  .btn{
    appearance:none;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.08);
    color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer;font-size:14px;
    transition:transform .12s ease, background .2s ease, border-color .2s ease; backdrop-filter:blur(6px);
  }
  .btn:hover{transform:translateY(-1px);background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.22)}
  .muted{opacity:.8}
  .stack{display:grid;gap:10px}
  .center{display:grid;place-items:center;text-align:center}
  .pill{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;font-size:13px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04)}
  .pill.ok{border-color:rgba(103,232,249,.35);box-shadow:0 0 0 2px rgba(103,232,249,.1) inset}
  .pill.warn{border-color:rgba(253,230,138,.35);box-shadow:0 0 0 2px rgba(253,230,138,.1) inset}
  .pill.err{border-color:rgba(252,165,165,.35);box-shadow:0 0 0 2px rgba(252,165,165,.1) inset}
  .heart{width:90px;height:auto;transform-origin:center;animation:pulse 1.9s ease-in-out infinite;filter:drop-shadow(0 12px 32px rgba(255,91,137,.22))}
  @keyframes pulse{0%{transform:scale(1)}30%{transform:scale(1.06)}60%{transform:scale(1)}100%{transform:scale(1)}}
  .grid2{display:grid;grid-template-columns:1fr auto;align-items:end;gap:10px}
  .problem{font-size:28px;font-weight:700;letter-spacing:.5px}
  .lives{display:flex;gap:4px}
  .life{font-size:20px}
  .timer{font-variant-numeric:tabular-nums;font-weight:600}
  .codeBox{
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    background:rgba(0,0,0,.35);border:1px dashed rgba(255,255,255,.25);border-radius:12px;padding:14px;letter-spacing:1px;
    box-shadow: inset 0 0 30px rgba(255,91,137,.05);
  }
  .hint{font-size:13px;opacity:.85}
  footer{margin-top:14px;text-align:center;opacity:.7;font-size:12px}
  .floaters{position:absolute;inset:-10px;pointer-events:none;overflow:hidden;z-index:-1}
  .floater{position:absolute;bottom:-40px;font-size:18px;opacity:.85;animation: rise linear forwards;
    filter: drop-shadow(0 6px 12px rgba(0,0,0,.35))}
  @keyframes rise{to{transform:translateY(-120vh) rotate(20deg);opacity:0}}
  @media (max-width:560px){ .section{min-width:unset} .grid2{grid-template-columns:1fr} }
</style>
</head>
<body>
  <main class="wrap">
    <div class="card">
      <header>
        <div class="brand">Mona</div>
        <div class="tag">Daddy’s girl</div>
      </header>

      <div class="floaters" id="floaters"></div>

      <section class="section stack" id="step1">
        <div class="row center">
          <svg class="heart" viewBox="0 0 200 200">
            <path fill="var(--accent)" stroke="#d94770" stroke-width="2.4"
              d="M100 170 C100 170, 20 120, 35 70 C45 36, 80 36, 100 60 C120 36, 155 36, 165 70 C180 120, 100 170, 100 170 Z"/>
          </svg>
        </div>
        <label for="name">اكتبي اسمك عشان نخصص لك الهدية</label>
        <div class="grid2">
          <input id="name" type="text" placeholder="مثال: Mona" autocomplete="name" />
          <button class="btn" id="startBtn">ابدئي التحدّي</button>
        </div>
      </section>

      <section class="section stack" id="step2" hidden>
        <div class="row" style="justify-content:space-between">
          <div class="pill warn"><span>⏳</span>الوقت: <span class="timer" id="timer">180</span> ثانية</div>
          <div class="pill"><span>👤</span><span id="who"></span></div>
          <div class="lives" id="lives">
            <span class="life">💗</span><span class="life">💗</span><span class="life">💗</span>
          </div>
        </div>
        <div class="center" style="margin-top:8px">
          <div class="problem" id="problem">—</div>
        </div>
        <label for="answer">حلك هنا</label>
        <div class="grid2">
          <input id="answer" type="number" inputmode="numeric" placeholder="اكتبي الناتج" />
          <button class="btn" id="submitAnswer">تحقّقي</button>
        </div>
        <div class="hint">عندك ٣ محاولات، والوقت ٣ دقايق ⏳</div>
      </section>

      <section class="section stack" id="step3" hidden>
        <div class="center">
          <div class="pill ok"><span>🎉</span> مبروووك يا شطوورة أعرف أنك بتحلّينها صح لأنك دلوعة بابا</div>
        </div>
        <div class="codeBox center" style="margin-top:10px">
          <div id="code" style="font-size:22px;font-weight:800;letter-spacing:2px">X4RLPJKC78HCZJCW</div>
          <div class="row" style="margin-top:10px">
            <button class="btn" id="copyCode">نسخ الرمز</button>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const COUNTDOWN = 180;
const LIVES_TOTAL = 3;
const FIXED_CODE = "X4RLPJKC78HCZJCW";

const floaters = document.getElementById('floaters');
const HEARTS = ["💗","💖","💘","💞","💓","💕"];
function spawnHeart(){
  const el = document.createElement('span');
  el.className = 'floater';
  el.textContent = HEARTS[(Math.random()*HEARTS.length)|0];
  el.style.left = (Math.random()*100) + 'vw';
  el.style.fontSize = (16 + Math.random()*26) + 'px';
  el.style.animationDuration = (6000 + Math.random()*6000) + 'ms';
  floaters.appendChild(el);
  el.addEventListener('animationend', ()=> el.remove());
}
(function loop(){ spawnHeart(); setTimeout(loop, 420+Math.random()*900) })();

let currentAnswer = 0;
let lives = LIVES_TOTAL;
let timer = COUNTDOWN;
let timerId;

function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min }
function newProblem(){
  const a = randInt(3,12), b = randInt(2,11), c = randInt(2,9);
  if(Math.random() < 0.5){
    currentAnswer = (a + b) * c;
    return `(${a} + ${b}) × ${c} = ?`;
  }else{
    currentAnswer = a * b + c;
    return `${a} × ${b} + ${c} = ?`;
  }
}

document.getElementById('startBtn').addEventListener('click', () => {
  const name = document.getElementById('name').value.trim();
  if(!name){ alert('اكتبي اسمك أول 👇'); return; }
  document.getElementById('who').textContent = name;
  step1.hidden = true; step2.hidden = false;
  document.getElementById('problem').textContent = newProblem();
  timer = COUNTDOWN; document.getElementById('timer').textContent = timer;
  lives = LIVES_TOTAL; document.getElementById('lives').innerHTML = '💗'.repeat(lives).split('').map(h=>`<span class="life">${h}</span>`).join('');
  clearInterval(timerId);
  timerId = setInterval(() => {
    timer--; document.getElementById('timer').textContent = timer;
    if(timer <= 0){ failChallenge('انتهى الوقت 😅'); }
  }, 1000);
});

document.getElementById('submitAnswer').addEventListener('click', checkAnswer);
document.getElementById('answer').addEventListener('keydown', (e)=>{ if(e.key==='Enter') checkAnswer(); });

function checkAnswer(){
  const val = Number(document.getElementById('answer').value);
  if(String(val)==='' || Number.isNaN(val)){ return; }
  if(val === currentAnswer){
    successChallenge();
  }else{
    lives--; if(document.getElementById('lives').lastElementChild) document.getElementById('lives').removeChild(document.getElementById('lives').lastElementChild);
    if(lives <= 0){ failChallenge('خسرتِ كل المحاولات 😅'); }
    else{
      document.getElementById('problem').textContent = newProblem();
      document.getElementById('answer').value = '';
    }
  }
}

function failChallenge(msg){
  clearInterval(timerId);
  alert(msg);
  step2.hidden = true; step1.hidden = false;
  document.getElementById('answer').value = '';
}

function successChallenge(){
  clearInterval(timerId);
  step2.hidden = true; step3.hidden = false;
  document.getElementById('code').textContent = FIXED_CODE;
  for(let i=0;i<24;i++){ setTimeout(spawnHeart, i*60); }
}

document.getElementById('copyCode').addEventListener('click', async ()=>{
  try{ await navigator.clipboard.writeText(FIXED_CODE); alert('اننسخ ✅'); }
  catch { alert('انسخي يدويًا: ' + FIXED_CODE); }
});
</script>
</body>
</html>
